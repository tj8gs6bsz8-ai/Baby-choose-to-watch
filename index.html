<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ°´æœè¸©åœ°é›·</title>
    <style>
        /* æ‰‹æ©Ÿæ˜“è®€ç‰ˆé¢è¨­å®š */
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f2f5;
            font-family: "Microsoft JhengHei", sans-serif;
        }

        /* éŠæˆ²ä¸»å®¹å™¨ï¼šç¶­æŒ 4:5 æ¯”ä¾‹ */
        #game-container {
            width: 90vw;
            max-width: 400px;
            aspect-ratio: 4 / 5;
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
            position: relative;
        }

        /* æ¨™é¡Œèˆ‡ç‹€æ…‹å€ */
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        h1 { margin: 0; font-size: 1.5rem; color: #333; }
        p { margin: 5px 0 0; color: #666; font-size: 1rem; }

        /* 3x3 ä¹å®®æ ¼å€åŸŸ */
        #grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            flex-grow: 1;
        }

        /* æ ¼å­æ¨£å¼ */
        .cell {
            background-color: #81ecec;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            transition: transform 0.1s, background-color 0.3s;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .cell:active { transform: scale(0.95); }

        /* ç¿»é–‹å¾Œçš„æ¨£å¼ */
        .cell.safe { background-color: #ffeaa7; cursor: default; }
        .cell.boom { background-color: #ff7675; cursor: default; }
        .cell.revealed { transform: rotateY(180deg); }

        /* é‡æ–°é–‹å§‹æŒ‰éˆ• */
        #restart-btn {
            margin-top: 20px;
            padding: 15px;
            border: none;
            background-color: #0984e3;
            color: white;
            font-size: 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            display: none; /* éŠæˆ²çµæŸæ‰é¡¯ç¤º */
        }
    </style>
</head>
<body>

<div id="game-container">
    <header>
        <h1>å°‹æ‰¾æ°´æœ</h1>
        <p id="status-text">è«‹æ‰¾å‡ºæ‰€æœ‰ 6 å€‹æ°´æœï¼</p>
    </header>

    <div id="grid">
        </div>

    <button id="restart-btn" onclick="initGame()">å†ä¾†ä¸€å±€</button>
</div>

<script>
    // --- éŠæˆ²è¨­å®š ---
    const totalCells = 9;
    const safeCount = 6;
    const boomCount = 3;
    
    // åœ–ç¤ºåº«
    const fruitIcons = ['ğŸ', 'ğŸŒ', 'ğŸ‡', 'ğŸŠ', 'ğŸ“', 'ğŸ‘']; // å®‰å…¨åœ–ç¤º
    const bombIcon = 'ğŸ’£'; // çˆ†ç‚¸åœ–ç¤º

    // ç‹€æ…‹è®Šæ•¸
    let gridData = []; // å„²å­˜æ¯ä¸€æ ¼æ˜¯å®‰å…¨é‚„æ˜¯ç‚¸å½ˆ
    let revealedCount = 0;
    let isGameOver = false;

    // --- éŸ³æ•ˆè¨­å®š (è«‹å°‡å­—ä¸²æ›¿æ›ç‚ºæ‚¨çš„éŸ³æ•ˆæª”è·¯å¾‘) ---
    // ç¯„ä¾‹ï¼š const soundSafe = new Audio('safe.mp3');
    // é€™è£¡ä½¿ç”¨ç€è¦½å™¨å…§å»ºç°¡å–®é »ç‡æ¨¡æ“¬ï¼Œæˆ–è«‹æ‚¨è‡ªè¡Œæ”¾å…¥æª”æ¡ˆ
    const soundSafe = new Audio(''); // å¡«å…¥å®‰å…¨éŸ³æ•ˆè·¯å¾‘
    const soundBoom = new Audio(''); // å¡«å…¥çˆ†ç‚¸éŸ³æ•ˆè·¯å¾‘
    const soundWin = new Audio('');  // å¡«å…¥éé—œéŸ³æ•ˆè·¯å¾‘

    // åˆå§‹åŒ–éŠæˆ²
    function initGame() {
        const grid = document.getElementById('grid');
        const statusText = document.getElementById('status-text');
        const restartBtn = document.getElementById('restart-btn');
        
        grid.innerHTML = ''; // æ¸…ç©ºç›¤é¢
        statusText.textContent = 'è«‹æ‰¾å‡ºæ‰€æœ‰ 6 å€‹æ°´æœï¼';
        statusText.style.color = '#666';
        restartBtn.style.display = 'none';
        isGameOver = false;
        revealedCount = 0;

        // 1. ç”¢ç”Ÿæ•¸æ“šï¼š6å€‹æ°´æœ + 3å€‹ç‚¸å½ˆ
        let baseArray = Array(safeCount).fill('safe').concat(Array(boomCount).fill('boom'));
        // 2. éš¨æ©Ÿæ‰“äº‚ (Fisher-Yates Shuffle)
        for (let i = baseArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [baseArray[i], baseArray[j]] = [baseArray[j], baseArray[i]];
        }
        gridData = baseArray;

        // 3. ç”Ÿæˆ HTML æ ¼å­
        for (let i = 0; i < totalCells; i++) {
            const cell = document.createElement('div');
            cell.classList.add('cell');
            cell.dataset.index = i;
            cell.addEventListener('click', () => handleClick(i, cell));
            grid.appendChild(cell);
        }
    }

    // é»æ“Šè™•ç†
    function handleClick(index, cellElement) {
        if (isGameOver || cellElement.classList.contains('revealed')) return;

        const type = gridData[index];
        cellElement.classList.add('revealed');

        if (type === 'safe') {
            // --- å®‰å…¨æƒ…æ³ ---
            // éš¨æ©Ÿé¸ä¸€å€‹æ°´æœåœ–ç¤ºé¡¯ç¤º
            const randomFruit = fruitIcons[Math.floor(Math.random() * fruitIcons.length)];
            cellElement.textContent = randomFruit;
            cellElement.classList.add('safe');
            
            playSound('safe');
            revealedCount++;

            // æª¢æŸ¥æ˜¯å¦éé—œ (6å€‹å…¨é»å®Œ)
            if (revealedCount === safeCount) {
                gameWin();
            }
        } else {
            // --- çˆ†ç‚¸æƒ…æ³ ---
            cellElement.textContent = bombIcon;
            cellElement.classList.add('boom');
            playSound('boom');
            gameOver();
        }
    }

    function gameOver() {
        isGameOver = true;
        document.getElementById('status-text').textContent = 'ğŸ’¥ ç³Ÿç³•ï¼è¸©åˆ°åœ°é›·äº†ï¼';
        document.getElementById('status-text').style.color = '#e74c3c';
        document.getElementById('restart-btn').style.display = 'block';
        revealAll();
    }

    function gameWin() {
        isGameOver = true;
        document.getElementById('status-text').textContent = 'ğŸ‰ æ­å–œï¼æ°´æœå…¨éƒ¨æ‰¾åˆ°äº†ï¼';
        document.getElementById('status-text').style.color = '#27ae60';
        document.getElementById('restart-btn').style.display = 'block';
        playSound('win');
    }

    // éŠæˆ²çµæŸæ™‚é¡¯ç¤ºæ‰€æœ‰ç­”æ¡ˆ
    function revealAll() {
        const cells = document.querySelectorAll('.cell');
        cells.forEach((cell, i) => {
            if (!cell.classList.contains('revealed')) {
                cell.classList.add('revealed');
                if (gridData[i] === 'safe') {
                    cell.textContent = 'ğŸ'; // æœªç¿»é–‹çš„å®‰å…¨æ ¼é¡¯ç¤ºé è¨­æ°´æœ
                    cell.style.opacity = '0.5';
                } else {
                    cell.textContent = 'ğŸ’£';
                }
            }
        });
    }

    // ç°¡å–®çš„éŸ³æ•ˆæ’­æ”¾åŒ…è£å™¨
    function playSound(type) {
        // å¦‚æœæ‚¨æœ‰å¯¦éš›éŸ³æ•ˆæª”ï¼Œè«‹å–æ¶ˆè¨»è§£ä¸‹æ–¹ä»£ç¢¼
        /*
        if (type === 'safe' && soundSafe.src) soundSafe.play();
        if (type === 'boom' && soundBoom.src) soundBoom.play();
        if (type === 'win' && soundWin.src) soundWin.play();
        */
        console.log(`æ’­æ”¾éŸ³æ•ˆ: ${type}`);
    }

    // å•Ÿå‹•éŠæˆ²
    initGame();
</script>

</body>
</html>
